## Cookie와 Session

* HTTP 프로토콜을 기반으로 사용자와 통신한다.  
    * HTTP는 상태가 없으므로 페이지 이동 시마다 서버와 연결해야한다.  
    * 상태유지, 장바구니 기능 구현 등이 까다롭다.  
* Stateless 를 해결하는 2가지 방식이 세션과 쿠키이다.  
    * 세션: 서버에서 연결 정보를 관리한다.  
    * 쿠키: 클라이언트(브라우저)에서 연결 정보를 관리한다.  


### Cookie
* what

쿠키는 사이트를 방문하고 이용할 때 브라우저에 저장되는 데이터인데, 웹 서버에서 생성되며, 사용자를 식별할 수 있는 key-value 쌍으로 이루어진 String 형태를 갖는다.

무상태 프로토콜인 HTTP 환경에서 상태를 유지하기 위한 기술이다. 데이터를 브라우저 측에 저장해두고 매 요청시 마다 서버로 쿠키를 전송한다. 따라서 페이지가 새로고침되거나 새로운 요청이 발생된다고 해도 클라이언트측의 브라우저에 데이터가 저장된 상태로 이동된다.

* when  
1. 최초 페이지에서 로그인하고 여러 페이지에 걸쳐 로그인 인증정보가 유지되어야하는 경우
2. 쇼핑몰과 같은 사이트에서 장바구니에 담긴 아이템 정보들이 다른 페이지로 이동 시에도 유지되어야하는 경우
3. 새로고침과 같은 경우에도 사용자의 상태가 변경되지 않아야하는 경우
4. 이전 단계의 페이지의 정보들이 유지되어야하는 경우
5. 하루 안보기
   -> 지워지거나, 조작되거나, 가로채이더라도 큰 일은 없을 그런 수준의 정보를 브라우저에 정보를 저장할 때 사용.

* how  
    1. Client가 Http Request를 서버에 보낸다.
    2. Server는 setCookie() 함수를 통해 쿠키를 설정하고, Http 헤더와 함께 쿠키를 클라이언트에게 전송한다.
    3. 클라이언트는 Http Request를 할 때 마다 쿠키를 설정한 뒤, 서버로는 Http Header에 담아서 보낸다.
    
서버가 쿠키를 생성할 때에는 setCookie() 함수를 사용하는데, "Name", "Value", "Expires"는 필수 표기 항목이다.  
쿠키는 사용자 컴퓨터에 파일로 남겨지기 때문에 보안상에 문제가 발생할 수 있다.

## Session
* what
  세션이란 서버가 해당 서버로 접근한 클라이언트를 식별하는 방법으로 서버는 접근한 클라이언트에게 response-header field인 set-cookie 값으로 클라이언트 식별자인 session-id를 응답한다.

일정 시간 동안 같은 사용자(브라우저)로부터 들어오는 일련의 요구를 하나의 상태로 보고 그 상태를 일정하게 유지시키는 기술이다. 여기서 일정 시간이란 방문자가 웹 서버에 접속해있는 상태를 하나의 단위로 보고 세션이라고 칭한다.

세션은 서버에 그 정보를 저장한다.

Client와 Web Server간 네트워크 연결이 지속적으로 유지된다. 처음 접속 시 클라이언트에게 유일한 아이디를 부여한다.
따라서 세션 아이디는 어떤 사용자의 세션인지를 식별하는 고유 ID로서의 역할을 한다.


* when
  세션은 서버에 저장되기 때문에 쿠키와는 다르게 정보가 노출되지 않는다. 따라서 서비스 관리자가 직접 관리해야할 중요한 정보들은 세션으로 서버 안에서 직접 다루어진다.

* how
<Session Id가 존재하지 않을 경우>
1. Client가 Http Request를 서버에 보낸다.
2. Session과 Session ID를 생성 및 저장한다.
3. setCookie 함수를 통해 쿠키에 세션 아이디를 담아 응답으로 돌려준다.

<Session ID가 존재할 경우>
1. client가 요청할 때 세션 아이디를 쿠키에 담아서 보낸다.
2. Session Id를 저장소에서 조회한 뒤 세션을 찾는다.
3. 필요한 정보를 응답에 담아 보낸다.

### 참고 자료
* https://en.wikipedia.org/wiki/HTTP_cookie
* [쿠키와 세션이란](https://juyoung-1008.tistory.com/2)
* [무하프로젝트 :: HTTP Session 이란?](https://mohwaproject.tistory.com/entry/HTTP-Session-%EC%9D%B4%EB%9E%80)
* [네트워크 HTTP 쿠키와 세션이란 ? :: 인생의 로그캣](https://noahlogs.tistory.com/38)
* [컨트롤러에서 쿠키 생성, 제거](https://kingle1024.tistory.com/94)