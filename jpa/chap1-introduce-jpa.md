## 1장 JPA 소개

### 1.1 SQL을 직접 다룰 때 발생하는 문제점
DAO를 이용하여 데이터베이스에서 회원을 조회하는 기능을 만들 때의 로직  
1. 회원 조회용 SQL을 작성한다.  
2. JDBC API를 사용해서 SQL을 실행한다.
3. 조회 결과를 resultSet을 활용하여 Member 객체로 매핑한다.

DAO를 사용하여 데이터베이스에 회원을 등록하는 기능을 만들 때의 로직  
1. 회원 등록용 SQL을 작성한다.
2. 회원 객체의 값을 꺼내어 등록 SQL에 전달한다.
3. JDBC API를 사용해서 SQL을 실행한다.

만약, 등록을 데이터베이스가 아닌 컬렉션에 한다면 어떻게 할 수 있을까?  
`list.add(member);` 단 한줄로 끝낼 수 있다.

---

멤버 객체의 필드가 수정되었을 경우, DAO에 작성해두었던 SQL 코드도 모두 재정의해야한다. 
즉, SQL 의존적이다. 비즈니스 요구사항을 모델링한 객체를 엔티티라 하는데, 이와 같이 SQL에 모든 것을 의존하는 상황에서는 개발자들이 엔티티를 
신뢰하고 사용할 수 없다. (why? 각 계층의 책임을 나누기 위해 계층을 구분하는데, 엔티티를 수정하고 나서 어쩔 수 없이 데이터 접근 계층을 열어 어떤 SQL이 실행되는지 
확인하고 수정해야하기 때문이다.)

#### 어떻게 JPA로 이를 해결할 수 있을까?
객체를 데이터베이스에 저장하고 관리할 때, JPA가 제공하는 API를 이용할 수 있다.
즉, SQL 작성 없이 JPA에서 제공되는 API만으로 CRUD 작업을 수행할 수 있다.

### 1.2 패러다임의 불일치
객체지향 - 추상화, 캡슐화, 정보은닉, 상속, 다형성 등 시스템의 복잡성을 제어할 수 있는 다양한 장치들을 제공  
RDBMS - 데이터 중심으로 구조화되어 집합적인 사고를 요구   

#### 상속
테이블은 상속이라는 개념이 없다. 대신, super type, sub type 관계를 사용하여 객체 상속과 유사한 형태로 테이블을 설계할
 수 있다. -> 이 방법은 관계를 정의하는 것과 같다. 하지만 이 방법을 이용하면 부모 객체에서 부모 데이터만 꺼내고, 자식 객체에서 자식 데이터만 꺼내어 
각각의 insert를 수행하거나, 조회할 때에는 JOIN에서 조회한 다음 각각에서 얻어낸 값을 조합해 하나의 객체를 생성해야한다. 
즉, 비용이 크다.

하지만 JPA를 사용하면 알아서 두 테이블에 나누어 저장해준다. 즉, 자바 컬렉션에 객체를 저장하듯이 JPA가 테이블에 데이터를 나누어 저장해준다.
#### 연관 관계
연관 관계가 있는 경우 외래 키를 변환하는 작업을 수행해야한다.
하지만 JPA를 이용하면 객체에 설정된 연관관계를 확인하여 객체와 연관관계를 함께 저장해주고, 또한 그 객체를 조회할 때 외래 키를 참조로 변환하는 일도 JPA가 처리해준다.

#### 객체 그래프 탐색
JPA를 사용하면 객체 그래프를 마음껏 탐색할 수 있다. JDBC API를 사용하면 연관된 객체 그래프를 조회하는 상황에 따라 메소드를 여러 벌 나누어 사용해야한다.

#### 비교
데이터베이스는 기본 키의 값으로 각 행을 비교한다. 반면 객체는 동일성 비교와 동등성 비교라는 두 가지 비교 방법이 있다.  
JDBC API를 이용하여 객체를 조회하는 쿼리를 작성한 뒤 조회해온 객체는 동일하지 않다. 왜냐면 같은 데이터베이스 로우에서 조회했지만, 객체 측면에서 볼 때
둘은 다른 인스턴스이기 때문이다. (memberDao.getMember()를 호출할 때 마다 새로운 Member 인스턴스가 생성된다.)

하지만 JPA에서는 같은 트랜잭션일 때 같은 객체가 조회되는 것을 보장한다.
```java
String memberId = "1";
Member m1 = jpa.find(Member.class, memberId);
Member m2 = jpa.find(Member.class, memberId);

m1 == m2; // true
```

> JPA는 패러다임의 불일치를 해결해주고 정교한 객체 모델링을 유지하게 도와준다.


### 1.3 JPA란 무엇인가?
JPA란 자바 진영의 ORM 기술 표준이다. 자바 애플리케이션과 JDBC 사이에서 동작한다.
* ORM이란?  
 객체와 관계형 데이터베이스를 매핑한다는 뜻이다. ORM 프레임워크는 단순히 SQL을 개발자 대신 생성해서 데이터베이스에 전달해주는 것 뿐만 아니라 앞서 이야기한 다양한 패러다임의 불일치
  문제도 해결해준다. -> 매핑 방법만 ORM에게 알려준다면 객체 측면에서는 정교한 객체 모델링을 할 수 있고 관계형 데이터베이스는 데이터베이스에 맞도록 모델링하면 된다. 
 
* 참고 자료  
- [JPA vs JDBC, JPA vs Mybatis, JPA vs Spring Data JPA의 차이점과 Hibernate](https://skyblue300a.tistory.com/7)
